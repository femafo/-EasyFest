#!/bin/bash

# Configura las variables
DB_NAME="nombre_base_de_datos"
DB_USER="usuario"
DB_PASS="contraseña"
BACKUP_DIR="/ruta/al/directorio/de/backup"
TIMESTAMP=$(date +"%F")
BACKUP_FILE="${BACKUP_DIR}/${DB_NAME}_${TIMESTAMP}.sql.gz"
GDRIVE_FOLDER_ID="tu_google_drive_folder_id"

# Crear un dump de la base de datos y comprimirlo
mysqldump -u $DB_USER -p$DB_PASS $DB_NAME | gzip > $BACKUP_FILE

# Subir el archivo a Google Drive
gdrive upload --parent $GDRIVE_FOLDER_ID $BACKUP_FILE

# Eliminar copias de seguridad locales más antiguas de 7 días
find $BACKUP_DIR -type f -name "*.sql.gz" -mtime +7 -exec rm {} \;
